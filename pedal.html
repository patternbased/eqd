<!DOCTYPE html>
<html>
<head>
	<title>OnomatoPedal - Acapulco Gold Sampler</title>
	<meta charset="UTF-8">
  	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="google" value="notranslate">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script type="text/javascript" src="js/paper-full_0.12.3.js"></script>
	<script type="text/javascript" src="js/slick.min.js"></script>
    <script type="text/javascript" src="js/howler.js"></script>
<script type="text/javascript">

// Get PedalID as URL Parameter
    var pedalIDParam = new URLSearchParams(window.location.search);
    var keys = pedalIDParam.keys();
    for (key of keys);
    var entries = pedalIDParam.entries();
    for(pair of entries);
    function getUrlParameter(name) {
        name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
        var regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
        var results = regex.exec(location.search);
        return results === null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
    };
    var pedalNumber = getUrlParameter('pedalid'); 

// Connect to JSON
var paperRequest = new XMLHttpRequest();
if (!paperRequest) {
    alert('Giving up :( Cannot create an XMLHTTP instance');
}
paperRequest.open('GET','pedal-paperinfo.json', true);
paperRequest.onload = function() {
    var paperData = JSON.parse(paperRequest.responseText);
    var sampleQString = paperData[pedalNumber].sampleQ;
    var sampleQColor = paperData[pedalNumber].keyColorQ;
    var sampleWString = paperData[pedalNumber].sampleW;
    var sampleWColor = paperData[pedalNumber].keyColorW;
    var sampleEString = paperData[pedalNumber].sampleE;
    var sampleEColor = paperData[pedalNumber].keyColorE;
    var sampleRString = paperData[pedalNumber].sampleR;
    var sampleRColor = paperData[pedalNumber].keyColorR;
    var sampleAString = paperData[pedalNumber].sampleA;
    var sampleAColor = paperData[pedalNumber].keyColorA;
    var sampleSString = paperData[pedalNumber].sampleS;
    var sampleSColor = paperData[pedalNumber].keyColorS;
    var sampleDString = paperData[pedalNumber].sampleD;
    var sampleDColor = paperData[pedalNumber].keyColorD;
    var sampleFString = paperData[pedalNumber].sampleF;
    var sampleFColor = paperData[pedalNumber].keyColorF;
    var sampleZString = paperData[pedalNumber].sampleZ;
    var sampleZColor = paperData[pedalNumber].keyColorZ;
    var sampleXString = paperData[pedalNumber].sampleX;
    var sampleXColor = paperData[pedalNumber].keyColorX;
    var sampleCString = paperData[pedalNumber].sampleC;
    var sampleCColor = paperData[pedalNumber].keyColorC;
    var sampleVString = paperData[pedalNumber].sampleV;
    var sampleVColor = paperData[pedalNumber].keyColorV;
// Coloring Mobile Drumpads
	var mobileKeyQ = $('#keyQ');
	var mobileKeyW = $('#keyW');
	var mobileKeyE = $('#keyE');
	var mobileKeyR = $('#keyR');
	var mobileKeyA = $('#keyA');
	var mobileKeyS = $('#keyS');
	var mobileKeyD = $('#keyD');
	var mobileKeyF = $('#keyF');
	var mobileKeyZ = $('#keyZ');
	var mobileKeyX = $('#keyX');
	var mobileKeyC = $('#keyC');
	var mobileKeyV = $('#keyV');
	$(mobileKeyQ).css("background-color", sampleQColor);
	$(mobileKeyW).css("background-color", sampleWColor);
	$(mobileKeyE).css("background-color", sampleEColor);
	$(mobileKeyR).css("background-color", sampleRColor);
	$(mobileKeyA).css("background-color", sampleAColor);
	$(mobileKeyS).css("background-color", sampleSColor);
	$(mobileKeyD).css("background-color", sampleDColor);
	$(mobileKeyF).css("background-color", sampleFColor);
	$(mobileKeyZ).css("background-color", sampleZColor);
	$(mobileKeyX).css("background-color", sampleXColor);
	$(mobileKeyC).css("background-color", sampleCColor);
	$(mobileKeyV).css("background-color", sampleVColor);

// Paper.js setup
paper.install(window);
    $(document).ready( function() {
        paper.setup('myCanvas');
            
// Paper + Howler
            var keyData = {
                q: {sound: new Howl({ src: sampleQString}),
                    color: sampleQColor},
                w: {sound: new Howl({ src: sampleWString}),
                    color: sampleWColor},
                e: {sound: new Howl({ src: sampleEString}),
                    color: sampleEColor},
                r: {sound: new Howl({ src: sampleRString}),
                    color: sampleRColor},
                a: {sound: new Howl({ src: sampleAString}),
                    color: sampleAColor},
                s: {sound: new Howl({ src: sampleSString}),
                    color: sampleSColor},
                d: {sound: new Howl({ src: sampleDString}),
                    color: sampleDColor},
                f: {sound: new Howl({ src: sampleFString}),
                    color: sampleFColor},
                z: {sound: new Howl({ src: sampleZString}),
                    color: sampleZColor},
                x: {sound: new Howl({ src: sampleXString}),
                    color: sampleXColor},
                c: {sound: new Howl({ src: sampleCString}),
                    color: sampleCColor},
                v: {sound: new Howl({ src: sampleVString}),
                    color: sampleVColor}               
            };
            var circles = [];
            var canvasWidth = window.innerWidth;
            var canvasHeight = window.innerHeight;

            function squareClickEvent(key) {
                var randomPointWidth = canvasWidth * Math.random();
                var randomPointHeight = canvasHeight * Math.random();
                var randomePoint = new paper.Point(randomPointWidth, randomPointHeight);
                var newCircle = new paper.Path.Circle(randomePoint, 500);
                newCircle.fillColor = keyData[key].color;
                keyData[key].sound.play();
                circles.push(newCircle);
            };

    $(document).keydown(function(event) { 
            if (keyData[event.key]) {
                var randomPointWidth = canvasWidth * Math.random();
                var randomPointHeight = canvasHeight * Math.random();
                var randomePoint = new paper.Point(randomPointWidth, randomPointHeight);
                var newCircle = new paper.Path.Circle(randomePoint, 500);
                newCircle.fillColor = keyData[event.key].color;
                keyData[event.key].sound.play();
                circles.push(newCircle);
                } else {}
        });
    
     var squareIDs = [	"keyQ", "keyW", "keyE", "keyR", "keyA", "keyS", "keyD", "keyF", "keyZ", "keyX", "keyC", "keyV"];
     var squareToKey = [	"q", "w", "e", "r", "a", "s", "d", "f", "z", "x", "c", "v"];
     var keyLength = squareToKey.length;
    
     for (i = 0; i < keyLength; i++) {
         document.getElementById(squareIDs[i]).onclick =  
         squareClickEvent.bind(this, squareToKey[i]);
     }
    //Animation for Key elements
    view.onFrame = function(event) {
        for (var x = 0; x < circles.length; x++) {
            circles[x].fillColor.hue += 1;
            circles[x].scale(0.9);
            if (circles[x].area < 1) {
                circles[x].remove();
                circles.splice(x, 1);
            }}};
    });
};
  paperRequest.send();

</script>
	<link rel="stylesheet" type="text/css" href="style.css" />
	<link rel="icon" type="image/png" href="images/patternBased_Logo_icon.png" />
</head>

<body>

<!-- Modal -->
	<div id="modalBG">
		<div class="loadingSpinner"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div>
		<div class="modalContent" id="modalScreen">
			<p>Press these keys below on your keyboard to play sample beats.<br><b>Z,X,C,V,A,S,D,F,Q,W,E,R</b></p>
			<img src="images/keysOnBoard.svg">
			<button class="modalButton" id="showStarter">OK</button>
		</div>
		<div class="modalContent" id="modalMobile"></div>
	</div>

<!-- Right Panel -->
	<div class="rightSPWrapper">
		<div class="rightSPgrayBG">
			<div class="close"><img src="images/closeIcon.svg"></div>
			<div class="rightSPOPlogo"><img src="images/onomatoPedal-Logo_Black.svg"></div>
		</div>
		<div class="rightSPgrayBG" id="aboutOP"></div>
		<div class="rightSPwhiteBG" id="howToPlay"></div>
		<div class="rightSPgrayBG" id="freeSamplePack"></div>
		<div class="rightSPwhiteBG" id="credit"></div>
		<div class="rightSPgrayBG" id="sidepanelLogos"></div>
	</div>

<!-- Tapping divs in Play mode mobile-->
	<div id="tapKeyWrap">
		<div class="tapKey" id="keyR"></div>
		<div class="tapKey" id="keyF"></div>
		<div class="tapKey" id="keyV"></div>
		<div class="tapKey" id="keyQ"></div>
		<div class="tapKey" id="keyW"></div>
		<div class="tapKey" id="keyE"></div>
		<div class="tapKey" id="keyA"></div>
		<div class="tapKey" id="keyS"></div>
		<div class="tapKey" id="keyD"></div>
		<div class="tapKey" id="keyZ"></div>
		<div class="tapKey" id="keyX"></div>
		<div class="tapKey" id="keyC"></div>
	</div>
	
<!-- Body -->
	<div class="wrap pedalPageWrap">
		<!-- Header -->
		<div class="header">
			<div class="info"><span>?</span></div>
			<div class="title-small"><a href="index.html"><img src="images/onomatoPedal-Logo-small.svg"></a></div>
			<div class="clear"></div>
			<div class="title-pedal" id="OnomoPedalHeader"></div>
			<div id="playModeHeader">
				<div class="pedal-small"> <img id="pedalSmall"></div>
				<div class="title-PlayMode"></div>
				<div class='clear'></div>
			</div>
		</div>
		<div class='clear'></div>

		<!-- Pedal -->
		<div id="pedal">
			<img id="thePedal">

			<!-- Circular Action Buttons -->
			<ul id="actions">
				<li class='actionBtn playAudio' id="listenBeat"><img src="images/playBeat.svg"><span>Play Beat</span></li>
				<li class='actionBtnMobile playAudio' id="playMode"><img src="images/playBeat.svg"><span>Play Mode</span></li>
				<li class='actionBtn' id="download"><img src="images/downloadSample.svg"><span>Download Sample</span></li>
				<li class='actionBtn' id="aboutPedal"><img src="images/seePedal.svg"><span>Check out Pedal</span></li>
				<li class='actionBtn' id='fullscreenMode'><img src="images/fullscreen.svg"><span>Full Browser Mode</span></li>
			</ul>

			<!-- Onomonapia Description-->
			<h1 id="onomoName"></h1>
			<p id="onomoInfo"></p>

			<!-- More Pedals -->

			<div id="morePedals">
				<div id="carouselWindow">
					<div class="arrows prev"></div>
					<div id="carousel">
						<img class="slide" data-pedal-id="4" src="images/pedalsOnom/Data-Corrupter-bgtx_V2.png">
						<img class="slide" data-pedal-id="0" src="images/pedalsOnom/Rainbow-Machine-bgtx.png">
						<img class="slide" data-pedal-id="10" src="images/pedalsOnom/Organizer-bgtx.png">
						<img class="slide" data-pedal-id="1" src="images/pedalsOnom/Acapulco-Gold-bgtx.png">
						<img class="slide" data-pedal-id="3" src="images/pedalsOnom/Arpanoid-bgtx.png">
						<img class="slide" data-pedal-id="2" src="images/pedalsOnom/Avalanche-Run-bgtx.png">
						<img class="slide" data-pedal-id="5" src="images/pedalsOnom/Disaster-Transport-SR-bgtx_V2.png">
						<img class="slide" data-pedal-id="6" src="images/pedalsOnom/Dream-Crusher-bgtx.png">
						<img class="slide" data-pedal-id="7" src="images/pedalsOnom/Hoof-Reaper-bgtx_V2.png">
						<img class="slide" data-pedal-id="8" src="images/pedalsOnom/Hummingbird-bgtx_V2.png">
						<img class="slide" data-pedal-id="9" src="images/pedalsOnom/Levitation-bgtx.png">
						<img class="slide" data-pedal-id="11" src="images/pedalsOnom/Palisades-bgtx.png">
						<img class="slide" data-pedal-id="12" src="images/pedalsOnom/Spatial-Delivery-bgtx_V2.png">
						<img class="slide" data-pedal-id="13" src="images/pedalsOnom/Afterneath-bgtx_V2.png">
						<img class="slide" data-pedal-id="14" src="images/pedalsOnom/Hoof-Fuzz-bgtx_V2.png">
					</div>
					<div class="arrows next"></div>
				</div>
			</div>
		</div>
		<div class="clear"></div>

		<!-- 'Show-all' button in full browser mode-->
		<div id="playModeIcons">
			<div id="showAll" class="actionBtn"><img src="images/showAll.svg"><span>Back to Pedal</span></div>
			<div id="pauseMobile" class="actionBtn"><img src="images/pauseBeat.svg"><span>Pause</span></div>
			<div id="mobileLogo"><img src="images/EQD-PB_logo@2x.png"></div>
		</div>

		<!-- BG Canvas for Paper.js -->
		<canvas id="myCanvas" resize></canvas>
	</div>

	<footer>
		<a href="https://www.earthquakerdevices.com/" target="_blank"><img src="images/EarthQuaker-Devices-Logo.png" class="footerLogo"></a>
		<a href="https://www.patternbased.com/" target="_blank"><img src="images/PatternBased_Logo_WHCL.png" class="footerLogo"></a>
	</footer>

	<script type="text/javascript" src="pedal-temp.js"></script>
	<script type="text/javascript" src="script.js"></script>
</body>
</html>